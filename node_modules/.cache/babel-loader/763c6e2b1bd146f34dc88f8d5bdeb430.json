{"ast":null,"code":"'use strict';\n\nconst {\n  PartialTypes\n} = require('../../util/Constants');\n/*\n\nABOUT ACTIONS\n\nActions are similar to WebSocket Packet Handlers, but since introducing\nthe REST API methods, in order to prevent rewriting code to handle data,\n\"actions\" have been introduced. They're basically what Packet Handlers\nused to be but they're strictly for manipulating data and making sure\nthat WebSocket events don't clash with REST methods.\n\n*/\n\n\nclass GenericAction {\n  constructor(client) {\n    this.client = client;\n  }\n\n  handle(data) {\n    return data;\n  }\n\n  getPayload(data, manager, id, partialType, cache) {\n    const existing = manager.cache.get(id);\n\n    if (!existing && this.client.options.partials.includes(partialType)) {\n      return manager.add(data, cache);\n    }\n\n    return existing;\n  }\n\n  getChannel(data) {\n    const id = data.channel_id || data.id;\n    return data.channel || this.getPayload({\n      id,\n      guild_id: data.guild_id,\n      recipients: [data.author || {\n        id: data.user_id\n      }]\n    }, this.client.channels, id, PartialTypes.CHANNEL);\n  }\n\n  getMessage(data, channel, cache) {\n    const id = data.message_id || data.id;\n    return data.message || this.getPayload({\n      id,\n      channel_id: channel.id,\n      guild_id: data.guild_id || (channel.guild ? channel.guild.id : null)\n    }, channel.messages, id, PartialTypes.MESSAGE, cache);\n  }\n\n  getReaction(data, message, user) {\n    const id = data.emoji.id || decodeURIComponent(data.emoji.name);\n    return this.getPayload({\n      emoji: data.emoji,\n      count: message.partial ? null : 0,\n      me: user ? user.id === this.client.user.id : false\n    }, message.reactions, id, PartialTypes.REACTION);\n  }\n\n  getMember(data, guild) {\n    return this.getPayload(data, guild.members, data.user.id, PartialTypes.GUILD_MEMBER);\n  }\n\n  getUser(data) {\n    const id = data.user_id;\n    return data.user || this.getPayload({\n      id\n    }, this.client.users, id, PartialTypes.USER);\n  }\n\n  getUserFromMember(data) {\n    if (data.guild_id && data.member && data.member.user) {\n      const guild = this.client.guilds.cache.get(data.guild_id);\n\n      if (guild) {\n        return guild.members.add(data.member).user;\n      } else {\n        return this.client.users.add(data.member.user);\n      }\n    }\n\n    return this.getUser(data);\n  }\n\n}\n\nmodule.exports = GenericAction;","map":{"version":3,"sources":["/Users/macbookpro/node_modules/discord.js/src/client/actions/Action.js"],"names":["PartialTypes","require","GenericAction","constructor","client","handle","data","getPayload","manager","id","partialType","cache","existing","get","options","partials","includes","add","getChannel","channel_id","channel","guild_id","recipients","author","user_id","channels","CHANNEL","getMessage","message_id","message","guild","messages","MESSAGE","getReaction","user","emoji","decodeURIComponent","name","count","partial","me","reactions","REACTION","getMember","members","GUILD_MEMBER","getUser","users","USER","getUserFromMember","member","guilds","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nconst { PartialTypes } = require('../../util/Constants');\n\n/*\n\nABOUT ACTIONS\n\nActions are similar to WebSocket Packet Handlers, but since introducing\nthe REST API methods, in order to prevent rewriting code to handle data,\n\"actions\" have been introduced. They're basically what Packet Handlers\nused to be but they're strictly for manipulating data and making sure\nthat WebSocket events don't clash with REST methods.\n\n*/\n\nclass GenericAction {\n  constructor(client) {\n    this.client = client;\n  }\n\n  handle(data) {\n    return data;\n  }\n\n  getPayload(data, manager, id, partialType, cache) {\n    const existing = manager.cache.get(id);\n    if (!existing && this.client.options.partials.includes(partialType)) {\n      return manager.add(data, cache);\n    }\n    return existing;\n  }\n\n  getChannel(data) {\n    const id = data.channel_id || data.id;\n    return (\n      data.channel ||\n      this.getPayload(\n        {\n          id,\n          guild_id: data.guild_id,\n          recipients: [data.author || { id: data.user_id }],\n        },\n        this.client.channels,\n        id,\n        PartialTypes.CHANNEL,\n      )\n    );\n  }\n\n  getMessage(data, channel, cache) {\n    const id = data.message_id || data.id;\n    return (\n      data.message ||\n      this.getPayload(\n        {\n          id,\n          channel_id: channel.id,\n          guild_id: data.guild_id || (channel.guild ? channel.guild.id : null),\n        },\n        channel.messages,\n        id,\n        PartialTypes.MESSAGE,\n        cache,\n      )\n    );\n  }\n\n  getReaction(data, message, user) {\n    const id = data.emoji.id || decodeURIComponent(data.emoji.name);\n    return this.getPayload(\n      {\n        emoji: data.emoji,\n        count: message.partial ? null : 0,\n        me: user ? user.id === this.client.user.id : false,\n      },\n      message.reactions,\n      id,\n      PartialTypes.REACTION,\n    );\n  }\n\n  getMember(data, guild) {\n    return this.getPayload(data, guild.members, data.user.id, PartialTypes.GUILD_MEMBER);\n  }\n\n  getUser(data) {\n    const id = data.user_id;\n    return data.user || this.getPayload({ id }, this.client.users, id, PartialTypes.USER);\n  }\n\n  getUserFromMember(data) {\n    if (data.guild_id && data.member && data.member.user) {\n      const guild = this.client.guilds.cache.get(data.guild_id);\n      if (guild) {\n        return guild.members.add(data.member).user;\n      } else {\n        return this.client.users.add(data.member.user);\n      }\n    }\n    return this.getUser(data);\n  }\n}\n\nmodule.exports = GenericAction;\n"]},"metadata":{},"sourceType":"script"}